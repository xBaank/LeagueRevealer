import io.ktor.utils.io.*
import io.ktor.utils.io.jvm.javaio.*
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.isActive
import kotlinx.coroutines.launch
import kotlinx.coroutines.runBlocking
import leagueProxy.LeagueProxyClient
import org.junit.jupiter.api.Test
import rtmpClient.packet.RTMPPacketDecoder
import rtmpClient.packet.RtmpPacketEncoder

class LeagueProxyTest {

    @Test
    fun `should decode`(): Unit = runBlocking {
        val data =
            "030000000053731400000000020007726563656976650505100024666c65782e6d6573736167696e672e6d657373616765732e4173796e634d65737361676500076865616465727303000a4453537562746f70696302000c636e2d323230363031393535000009000a74696d65546f4c6976650000000000000000000008636c69656e74496402000c636e2dc3323230363031393535000b64657374696e6174696f6e0200146d6573736167696e6744657374696e6174696f6e00096d657373616765496402002439363663313031662d326430632d343732642d613430372d376439636563366230656539000d636f7272656c6174696f6e4964050004626f647910005a636f6d2e72696f74c367616d65732e706c6174666f726d2e636c69656e742e64796e616d69632e636f6e66696775726174696f6e2e436c69656e7444796e616d6963436f6e66696775726174696f6e4e6f74696669636174696f6e0007636f6e666967730251e4483473494141414141414141414f32394459386a795a45592b6c6357665044424438c36671726f2b73727745456d64334e3775454f75396c4c736d64326231636773717179756b744473716771636e703652774f635038356e772b65546a4366667333302b48417a66325437426435614d4d79424c4f50765061485a582f3849526d566e46797170695438384d665a5941537a7664485a575a6b5a4752455a45522b66c36d714d396b7346756d535a5a3148727a6f66503576326c7a535973366a7a614a3174324f74755a7868756a74506c6d6933585535706473335779764d61635137706b70386c387a624b797748497a6e33633735326c453537567655356f506c74637358796670386f544e366431674f574668756f7a79736852647254686d4155c335753074734a57324e6c2b576d613965627a626359633672775456522f66304d554b634136545262497563677a5a437a5a764a57314d6c382f62616134693565576e4e786e4c62394a356d6156334e4158365259344a6e5a65316a646d4c354156747230394265312f614362334c4a386b795a45503465676e387165524c3868c378616d4c63696162425a646c427676633653594c4e6d6b3357613057743252484e326c53556c68394b51596c63496e486b443654705a7a396b436572793931703356564b716f7375756878657539566556736f7a393259686d6e38336d3657562b4736327133733669566c69715a5a316d3657556d42524c6c50615152346368c35432703353655249506c4332424a6d74314e3731594d506e632b2f364c545078394e2b313930756c39306e7658474a37504a6b3845466836616a712f46463737782f4d5a3264446e746e39572f5438656a793857654e6e4750347a542b4f2b326539346141334f7837334a31506c793148763471492f35702f4f527966393265c356346441615a4a6f505278577a6352794a343276486f2f4c4a33415239464861665432586e76736b496566446a706e66664f2b764c62647a71464d4533574e4a766330437a4b4a7978376b59545955725145336334467535553875557a4335785657697553726e44306c4d735070504c3074766864386c4f69754d6c446c7a73c3313676636f664852374f5a6549423239776142334e47727a63736a6566736d6f46744f416a545261636935414a663251327443446d656b4b344f7369526458394d4655374673573365317573356f784c6155517065665a676e554f77624c744144706a37694f3850342f7053454c3076543531584b654c4a39446a564f32574dc333706d68567939446742564c78307275706d4c3472453936504e65703075532f75327075744e336e2b3553724b373832512b54387069702f52375136696a707547584c41756831567656754537796463594a7641523550396d49763156556f757a54684e32432f627745653130615554546f4e467a6e4c5332706f7835446d6fc36f5762664d30546566545a4656386772362f67424976574d476f7937524d362b56354769596358307431334e674a6b777432486b5473496c306e63534c735534304a4538517a76324472327a523758704b7a7330396b49302f596d69627a74715957784e35506f525163587666574f49536279303057336f4264665a5a455949c3685153693753355a6a46477841634b484353354f47634a6f75476e687a543153694c774f77324246634c356874324d452f6e422f6e31366d4431596e57775a4f7644584b726849556a315963704c796c3861585357484c387a44706f34496531394676354c5561726563334a3336566d59552b52423330644357467356306e71c35069544d4145433765672b4776725049786573437744395141527a744d6c474e49765754534b593441772f3257574c6c4c6b5047726d65677259675768544e30314e647a58546d42724f493132482f773530586639742f686453564253366f447a2f5a784e4c777a496430664c434d4979486b41594e68585a4357335a596c38c365625147304f74456155422f6d4a6b39496a7555777a364752434c426836626d42776a49356f2b507761686f7a6c746d424a5633385a4b5533784e4e4e766234717336354b75627944337173496a4c65564d4f68547458616468577533506a744444432f71694d43784658357978644c434d553253754d7468684572414c3663c36f6d6438755163312b596c564538546464307a704f6d4b5362326f4b333667566352724149394b4f7736547250463547617a6a744c6270564a506d516e364d6d473867306372746b5477546d51714a4c52715a6f347a466745566f462f356d4831766b32526251613561412b3434547344684133322f6c705444654e39355a42c37a6f4451306f2b4a716c4c336558515837454d414355476249306f45457954395a3332487a64514e617a425177542f586c796e596955552b686b326235616e5249454f7a5a6c6448473053656167705a3973324b59595134457a7a3244736d5478506c6f567776554c6275585531424b49693034544e5753674d6f53774f4475c339387a74435678714c486378685a316a69576f4b6756314a54736632713245396a6d7942772f377031666f684e522b67697151314f6b3133325734656873314f4a7862503269796458352b5168636c746e67574b62316a6838502b6b2f377768456154496439345834637732416a576c756a2b705442574a6d7877584b647058c356565061637671794979325152356d4357727262675555595a6434643356436f5a3270715a4456783976386e5736414e556263476b734a4c616b4139334949716b77616c736e4a776a75747031544b336d5a3574775855557539356f6f644a3350526d646a686561746e31552f7a5156686869327737664d5a68654a32733042c34b4d49486f6f6b3542554c6e676a454c514e2b6732576a4f526b7743516b7136693273504374346e4a4b5836525a737437366756676278794f51774a2f515a456e4a6c6a68654668716556414b4e63676a45306c4e777630446e5a4d463634775935446a667063676b31564875347a6c6e674678394e4a376369674e79424468c367537059756939656a54384a4152784b6358536938504a414463704952787a59504b77516c6f6b5941324c43435a594733514f7a4441744d766d7454436e377155354e756175646f41594e4178447754466d4b786837477370634c5863506830527034457a6444646c4235424d4774713844346634736f4d735a58533542666bc34965444d3757736f2b464350526871475046344e5041656235707156506c6e307845493177597963376e6d744839794f782b524379392b35455037506e49304533386166472f4366384a33394667464d4946376c74797655514b6538746b306553426b50794c46554e7848374e6239503648365856533539526a534143424b4bc35a4475452f616551533164357066446231626f4772776d332f64595175416c6963305731416b35566d617a6150633141333361616f77717868467852534248456552355a6470416a48356d4f5673666337796e41396b52575a776e5955765059615252457a6d394935416a41456e3449595266674d576e377577676b374f3873c3454a384e77794f6d694b2f713937397266696e764735744a6672445a33336f343351574f41455a2f61774e356e4f48672b6d67416362686231796b734a34454348687133584630344c4f7271614d67574573773036584d74594c517a543754304636747245553943624e633469646f695a487855786234614b564e686a713662c3306f497664325a364b3078446567486e7965704d304b50636c346574327374745a66386548455a39364d5a71476264444f504d504c6b52473748564b3446522b7947766b6a53544f67384f717a486f4a594e49337163526d77555135394158367a726d7471666f4f6e6b58544d346d63462f6452497570374f6a38617a4f6c35c379584173454643724d317874446e79584c4442314177374c2f7a65445a39317343304c5452594a75674a6f3468745579657a38302f723955774230654d474974445461783641465150666141622f3157335531517a2b7135752f71396e6a7873636e4d4651425556564b38443831307a6d5139316d446b69656a325a4d476336c3626a3262544a7359765a3562442b38656e464450367249775875745651316d4d3767763533394d457a42746139324178674a714c425a5a3338344f32756a72746667792f466b647677377a563645686a5337424c35654e5868324f7036644e716f61777667496e5466724c7749577a595342334d36557a584e77394a4e516f77c366304f563351354362693877507a634b4d78305662745a684d63727249304f675172646d41534a5730756b422f637242667a62323832535a522f3678582f396671334d676a4730755733586f6e66723339726e6f5a307a7237315376774747507944445977323845582b396272442b2b4b3432554d6748723137644f4b457275c36d32596665314b386e7a513579487964645131306c2f42763831652b6273714f586a354b784231636539326365587337714348344742675146546a4e68386e6a664a7754434c2b4b434739347974437a662b30785847674f4e4636632b65304c76526b716b4c4834573948783566346351306b3648654f452f424f4d50675055c3326673394a78477162703838324b542f557672342b42526650306572426d43334447746d34334a49464844637a767253426162585832704d664f3175464e4d595a584530367964495665617a346f5055644f6447554b4637307837434e777174693656727a693479677a7049304a7269553446396e6459456c446e4250456875c353564b73626e6b334c51344c62364c496e527a6c65643244704f34636977593772697051766d49756f4a4579613648795841353770706f692b3365517a756267505a78616470657359396c4b3258794e3237717858693435785235683845445676784b6159502b4178786d6f576365554f754d7a316f774455342b5464623547c36d3633676239787a6367313066676e49694a516879736254376c414c7a47344c7953506f684d304a616a7134755459582f79795048422b39554e4177506d4a673679453466567849482b54544f6a306379496a6c767058764c4d64665736534d58454a323967567650425a52376762694d45615454416b413041525577717330c3584976484d4d6c4d4756616b54584c5769736e587741446e5565397a2b64396f2f42656f31377039504278646b6a3232706e70376b546a64324742724549703534726435314f4748357155595264525a3033474e5948743167594332586d43715734554e396179565a745065394e2b2b4e42627a677a44485049614c59384233c34f6b324f42587232355a4d4262472f335872724444504d53794d2f2b7644466677365a456837666b697a6b455a4d7730436d49377071464555354e77463969496f336259617130725a5734732f76316a644a3241636a424d476e3942704c56594b51466b4375394e4f624a49744536434b776f64516f45535742414934512b4fc36671585a6637394c7766566a67676965415433567557675a4f5a637a653534783259786f46704777635154656a6f6845386f2b6d52666971434b643531784258492b353246575a334e336662504a7576434c2f38532f623239767335696d3262564d4133687a6b30474e312f7a5042443857414d3852676f6553416658344558c3702f73377947442b4b76694d613036784477435a653377502f4b6e396377567336374163532b3744627642756e4c7a624962336951596e7751736f334d4f514b79497954436764734f4d5556773236455a783947553357697a77482f78597258684e6f7270756e444847735853767736674c564e45317144514d6b52426c6751c3742f2f65564e3072334a4570486c75313875384e3958662f6250762f366e662f484c6e2f2b384f302b4b50417532534c4f374e445a387a30654b4b55626f3556663149786a2f6d3031532f4f624e6762456a3643345853643446546e5a7a476a4d517747352b41304c463661546473727970633036416d47362f7262496b5230c3584c372b684e6d6e59333833564738303057647a664c35435777716e763733614437387273722f506631582f2f48722f377742312f3937692b2b2b522f2f337a642f395a50756c7a6351743338584d47332f34707a2f457074327336472b3738506647376f554448767a5a2f2f7836352f2f2b4d30662f795838395264762f75c371662f75722f2f302f627633373573392f3935532f2b2f525a2b387a662f387333662f50544e7a2f374439744d332f2b3533762f6d39502f2f715a372f3335742f2b2f4d302f2f7230332f2f316664742f38347564762f76687633767a65762b6c2b3955652f2f2b59502f6769712b4e57662f4d5762662f4533434d4e66384fc3736e6233373051325434562f2f717a392f3832512b2b2b663066662f326a6e33377a567a392f3879642f3350337172332f38356f642f32763336442f2f5a4c332f32332f48586d2f2f36777a632f2f576e3336332f3770322f2b36422b392b5a2f2f48502f362b6f392f68722b2b2b656d2f3634724338746376662f35767676c372722f366f41582f2f6f7637333577552b2b2f735666662f4e662f764a582f2f412f7461523938772f2b364d30502f386c58662f4c6e582f3367687a4c3571352f3869312f2b37426553496b6e65332f2f52722f3742662b682b38362f2f5548416332662f4e662f757a4e332f77342b34332f2f5048762f7239503443474949c34a662f65742f3875596e50336a7a777a2f6f2f756f76662f444c6e2f2f6e72332f30707830784f6839746f756875736d4b686d50462b31616b37644a563539354f4d7872736e4f4173546d3137333576506838636c457a716473505a35386a584e4a4c4870476b3355762b75346d582b4d4d5578334239476a4d4d676774326bc34e6b615762454a44504e376844584b546846474a62714236356435726a4d6f4c4a36756932636c574c4d77436e676a322f585a645658533344506e344f3738587977464a4d4d4f4b6552627459314970723573426f782f794558644b47575876776378704c772b546c6267334c586a664b55506d66706938624539476d434c64c32f5a75504d6b616d6b5932465a5273723352364a59586e704b634c7855524f4536794c6c6955514b634d6c6d4b756668763039394f7a6371495463364e643731307677574650776a4a686d6f484e796e4236387a68644247426e49705372636a55457931586e7039356c58344579315669734665504d41773762387a75787055c364314948476e46497a445337544b6458342f54544b6349634a4a67484761722b7372727541507335694355564e484f6b76766d6c32634969334750412b2b57456258677a3874732b765a384d7671456763532b48446f647a334961454d4b6c6f4655782b3436627463337572375a395a30757a726c616867332f504367506151c341374270547a344a38502f774376443968384b47726f467634672b494f4444763577385966504a394c6d4e4c383572797649385131645030755755586f375a6a6d307471342f3047386743534234755243456f7a755532376f76415279766a75636c5179517a4447797661426f77417867425450424c486b487a69335a436b78c3332b703277754e70587a41766e44702f594e485a466830307a75536f42586a453051616c556a7137645a7037695459336658466a616e7a6852777748426e322f70786b714e6331706e43743436776643744e79704a4c6e515565744c56734e6a54324c583163696f386c3353595543396e764b43306f556968504b457a49434ac3796a3935465270705148573871456c4a4574322f68452f723169306a5851747a554d7a474a67716f4770427159696d587a324879662f4f31584275557858545a7458624f5435486e4268505530702b4d674e64736e744f6b4e6773677841367a456e57395077686b563149613168656f32376636357635764250427149316931c3446b4c3959392b4b72347965446961445456374a643275546f50526d6b466e7161306432495a4a633341316d31585656714d6a664267785551706c6e756372702b7a7537704d596136574261304a7a6f2f58766e46444739506159495a75384f596174334379534153437372596c474c486969397947536669792b59736b3365c352792b627953676975326d3055546c31636b6365396572446a425a394e7378444e50452b514c5967654f5a53703232616d6a754f78646e6f4a5952726850694b6e665730725557343263452b767378347349394a6c4e302b747275575172386734764c7176376f4e6a747039624a61516246676f326367796b54547a34314d4cc33432486d4838586d61755a4944684630654f6a7637496b443750474961484f7a343069326d704e676b7267334f2b527336334972486271743877694c6778384c7075313353367074586c697a45383933615945364e63612f6a486c694c696d3250776f39326c6d3077543262546e792f5357723939382b327036507373684a57c35466436a6d2f6667752f344969395758794c46357a704d2f5a7968537461754659744a317877345679734e4f46736b5a784453664b36526c655461306e63324655326144516d2b65735a7a6f434e547868624e66775a524137754143353231314a475163366a78504d30616778534f4b465537716a41774c2f6468344c655662c34e564234717a6a4337586f75703635364c3534664e5239475779415058672f7341453746446e455272737a753652346a79463974624a6c5a3744624c554a356b6b344137643450637453376b74314f6868624c34454a4d2b68364443466e75494b326d713176736e53396e6866625a696f315672626c51704c632b584e586d56c347744f7937495974787a575a317033527053336c4e675a5a462f78614b56324c324c4a6859382b666d386b676f634f57487a4e6555542b725673772f5157545838694e2b414d496e42346f49556e67393735364f4b6b5538312f7673696b6d634a766b4f6e7072755274316331705271797142324d4f626a465069784c595455c35a4267496b4548442f75445966396937502b57427430476c53334e4b354b766c4555674e5931386f4e6b466e6b4e72476b3636492b624e577a3530734b4e6b30334b5555675a7556726d6a455573716e4b526f35344d686b3835387676616253767476687a32706f4f4c713350653676754b4561576d566e6131746237474c62c3504b7256623256746a4643527a334c703638553464674b65762b7470694b374e5861636c3942717968493369347a54556b6e7171512f53446833632f747433484d627776595736535356416738536f4865546847314e2f6b3474714f586664762b444f7157744e782b73514f6244466169754e672b57667264562b687543346ac33959544d784b69666532594d6262465961386e38307737314f5839716d5a683144523074703735654f647a4e79375a4462656a5242634c7a72765461614e48746f4f5a62696a536267516464467471735944564e58344948746c7648316b66763842793158303756367a3856427a30576249486d54356d7161796a65756c5632c34d3855466c3232364f33744b4268494f2f68357a73502b377446346530577a482f623646307a4c6552747a6c46372f6d3037547049584353372f744e73566e4a665953742b376d54332f7266316f666144526579394836613155325138322b5532464e742f4441666d5151645776437165592b7849484358445339785a437272c37469376f58764d53316d42655555344863657172376d417830586370384b5049515a39773438393475717776743338786f4d6f525238662b6f376a4a6232423573684963474b412f3441773034653745697076486b504e2f7864485948374e4c4d33682b6958373433664673416a7a6b717a6a4b375a746270325a3374453444c34575762b415752723457557377747145644e6d704e714865772b6e4f6d704644696562774b4d34506b686b54425a55543750317369352f58534d6138424d484f7853316d574b65617371647235457838386134726e446467714b6d616c504e6b6e34584d3157364b6b38485333325262566a455a74746775427564374f486649c337715069526948616c4574534d54634b737957377944484a77704f553177492b3478585747726d6e544a413548486b33744a67746f34736c32643946715a71424a72592f6a6e3057622b76505472544e776c496b366c5950633170797a6133654974346e7036356677584e4161454e32595a7a754f4a6658506c356f6b58566ec3564e544e3278335639474b397a42586a3257794c477474746a5539545863304e30704b7a30464778445138446d655642434c6465467a364a5461516364346665383534736670676b327a424c6f6d5536625954744946546351753654546e4332766969397a44766f4b5047744c56555934354b486c432f4b376c346d674e4c67c37667354c6959792b656e6a4b62703078526e7534677530307a64384f3766753350767a6b4b635062326a382f5764324a65436252614c76617978773375597a6b4d614e3373546343424478466f6c50337148652b50775046703174782b6530703673365a7874543770596a71377a777934697458306a4b3235577a4f57714e44c3613755674433342f4c3536674966522f653630466e634869526d3351553859667757684f4a49656c6c64306537747366333661677558547878622b69657a3032482f30396b553939642f6a6f4f2b73676a542b6477672b4c4533377033584d7379554442495848714766586f3250526b586d7976664c336d41387153485a4972c367596e4432656e7666472f5a6e387a442f32503732614841304830392f68486f7270566c424f52734e5251514e2b50686f4d7a2f725063466658746f37504a70502b5a3356532b72337a61726c546f4770364e42794e546d626d53374e4b582f4833386241336564794778587070566650507269354561764552576c31537432c3335535474c3037477038576d4966585630413062504c7766475457695758342f35353736526672616557556d6e486c74504e6c685666734275722f4f314e6a7673586545744353664856644d5233785658514443382b4d363371683866395433745042734e686f394435364f5271434f54755374687939364a2f4f6872337469c3676d34356e7a306c4849564c68653456647650426c58506c656238325277635461374849314843714b695636724d77707a566a466a5a5a4844634968504753365053687931647764566e53394a5a3737795064314238577449346e42364e527657753558644e6a4b364f674374586c3657346a38626e4b752f6c6c3071744255c3384c2b484c634f35344f6a76765430576a59594739626b7a5837553647336a734535502b696639645871646e57665a49513836463835704d6d332b5137704854646f7454745935474253584e6a4331327a6b332f78756a4e34717161345a545a4c46616c35624574707550397175567256654f2f495544383965516b38716833c34d726c336b554e5466326f4d72625a4c49554e7a5056375861526a4e595a5979652b5351684e5053373746496c54476b777a326a696e2b726f387152754a58645851664c616d455631766f346e4f36505355373668386e697a48754b46317269345346656e63715533546e4339386763654d2b64564d785746434e6556795044c372755479616a692b466e48624833487077745555504439614268337272573252464c6456473151334254456c307535614c3349422b7462316a7078755a53514f7272364158765230755a6f5a4943512b3171313868666241656747594e4b316c54734b75422f31426b4f7a527246794732356736463154787a66496f764c6376c3586a594d6539783231656f4a443650753670724a634139334c454431665475647a43544c686b5544774b41434b4b31775a30304b7652585576764e4c775a594a77737666557478486c2f6668347a6c2b754c35386b53567a72726d3658352b694a6645656633416b6c393343796a6c75336d63694e575a516c636e4b78755978c3416f343172732f754c33414c427865666c48345342423642584b304b75786a5753636f684c486152317234582f674d6566436d573672586352394379715039426448784c656671367638353351643373696c56394566572f675a4335524e3351744d75784670427a7357396a7669625072673874504c6154706b313550472f73c35a345861326a486b5063304b79356236624269544c47346b3537757335374c3043324d4e4e673263766f6f6e4b65417a707165306843496972754e2f6a6f3152656442444c6b583351656659352f522f43485163442b345a376c4c32543158335443644a356d6d416e79474a674676706e797479562f452f6e6278742b765833c3644c644e5a2b305a6e766a713561334e675746783279753777747931755348464c466f7a38636a795878324a58792f734f4c6b364b344a4d4f716f5048656a6f625571436959573658476659664756496f35483859442b393135594c5551763139787464354f6c4656445633524d5654374d2f62544e65502b32765837396e64c36662552b6931512b694e512b4f72564a4f3349683173386c747a683257726e5250766f4d316730672b414f722f6f794e6d48513347536d3374534c38524568695174585445783038577a6e2f576e58335234612b2f42416d35467946627274794b3748453065676931697937743934587152734e7350786f586e514e6a626d2fc363575874454e4f46444c4e586f5737494e4a577447374f542f492b5543716547445876466167636f50416a6750396237384c344856353146586342315935304e672b4279594f774d6f6a75747a395846594c615375387636696a336f50556e4b46564b31706e3444337a4763544a66494f43663876507048555865644b463374c350794e63323663785a323532454f2f353533325359445074476c7475437a726e6b64497a384c656b367677594e537a795454526550514c6e6f7368392b4f7639564f56654e496337586c382b51464f33796c4633626765533576714872656348754c67376a62657a48455453416e624e317967784157774d31752b5932597746c3377a692f52656463524a7a65314d7076424e4d634a6979396e5a555a666c732f366b4737485a536238625a3750546354645a7a7762544476654b5149434f2b5457437975526a4b4c4166724d723631506e4d773232434a764d65766743665633775044384d626a444c6d682f4e77746f375833363664777859316e305535336cc36e5a476e35324734317138657a4c43396e615a6e4c37344d7043695073594737526a54764b395a334e35354d646f6a74666b3355702f577672367339746b4f567544684d77796e6a515447305974474f3374376c73796d54416176545754496535734b6359453049506d4568637633696a4b39306a556a63556e7549572f454fc3356e4e467332336543434873366b664162326f6f61326739767563596339386756585a65536458764148424b364e58646b344b54394e4d5a6c50367a634f445543786e6a687648664b5a2b4a6968676d6d69547a54467241673168562b5163785a69795a6b34716a326234363271427975494a41584b31724d77764d5375324ac36b54306b62634f567345496852375a2b4957764769444f4242646354365568646b6456313578655a47472f7a76716e773075507271384f686f4f6a6a393630762b4d662f7a2b2b65417350752f705a3865543735314e426f4631386b6e2f7150664a566139487a6935364a386448795364506a71342f4f523563506a36355075c33766354e6e6f35473535386f7977634a58614879382f2b58356947595030316b2b2f5231346171303965724d2b6633693137362b783758313539313266706252416e5a72514b4d2b2b33342b56713866456774332f3745323934504c5766484a736e69302b6652742f2f6b7031384f6a61656e74353439746e51765a34383834c378506e6d58362b4d3549446c66446754306448502f32532b503270666e6c78695854785842685a7038656e793076463676505470346c773848337235306566664c382b75724a4a6632596b6351367552326339443770485832667437422f63644a6f744a774b34584d705353616d3158767a3151317432584463626332696e68c3596541327448467a734f43673937463264587662502b36304f7843317a623844322b68336858494537386431726d2b49744172377877396c586c556d71352f377534555643755530334f5835686c57744f36462b4572446d686c495a78564373525361585739717a676e706762583151734b7470664a714e4e6b573975525065c36433455376475642726b596e32696d49364273665a4733756e3059524e4a4f4e653457654f38697a41635a5a69392f59707a685564344a4a614b652f753244424462794975424d2f2b3778763872377533447563615a4f4d5265765255347175504537654238686f34584b33626e34386f632f7941717a5539354c5156797559c37048512b43556e45376255536c342f456c593346685672377153564b6c4c58496d63386d4d6a4b755670564635794b4f612b65565a63786844584559353735344b3879767979676b483450776f56766648562b42524b6651544642736450536d42364f75574c5169556b316f4b323449537476646e77367149334c6c714b6e4ac3786d4e4d45685a476650565271477937393472476b795432766e6a6553556c54682b4f4f534876594e304f38376d3032512b5038596a54654c65595a796530506c6b5a364f45464e72744546394959694e6e77372f674a62647a4f4749374239344e554a50714d7346767542666f4963676c56564d333861684d503832566178c3364c7938694d306776616b6348636b5345766f384a58474b586933334a574359382f38474268496d375a7a6a6b35387359776e6d41344f764564782f547762427650412b342f5341676e534f51774456333872355a73386d516f3737576c57714b77595670465959794b647a664f327457342b6f5263726277384c535a5a7a4ec34963623266547459424263464164696e465a616356656e6a42356d3976755377616868754c6575354b7648785738772f6a2f4977514e732f684c4f454a6c516e2f6148312f306870505a63653979636f5558676f727666465942666c755259775530386a556e6a454b4e684b616e2b5735457449695a595552303567652b4c56c35273666264696f73786b3270744f70714f4c766b68497064504c7031517868424f357542654344717147367853486c4e3936417937355953696e623755314c763063476f61462f36425444723637416c483536445569566534324663746a677a486563717153442b4a69554e2f5267587a503051696854417469336462696750c367733176335151626d706b6139656d37717a76694f6f37336361444c4d4a44534c4c746a54546951324e574736736562727261495a46614551394b3254786539636f746c7731617453644944526f6f486d65795451533661376d5539765650437349484f4c5a666844463731766a3257683455712f5074533076386e32696862c345445049314e58364d756741375459797657593038336e506574723969437164514a54597a6a794c564d55777474716d74454a307a7a49735058504a432b794c4d5a42535653716e78346a584b2f587232526a6b657477504f7052754d596d426f596b655978366d716d5256777a424b34616a4c7876493855473858714e5867c352635a5961752b5978414737335930576a6b2b7642587744796268694372394c3237636479374f476d76316f5678774e5344574974304542775332703547476255313674753647337157362b76522b31613733582f584d437467505541735463306751514236436658374a676b304a3742745a72716d3433704e732f4c32576ec3473778736e56714e5555574c345a68723465613361676779557a6455667a49394254493261756230585544566e3441565732577750484e533348593943666759363636564974694278503033552f434b4c416f4b61746630436c4f77784359424c58734b45504b5167774361484e766d57486d684651346c44444a4378366e79c334744b6d327a435a5a6e366143454d4335457351324e4461436461434b4d45496a5259305a443630503673395573594c58455a59487036786f4d524361496b6564706e756b456d756e53574c646f5a4a486f512f70306832326765687a463149465268424a51476431482f684a4c63776e316d636343336150765977434c5774c37631314b522b594c737766726d784135317167586e7777464b4152585273782f64646a336a765978374b54743174495a686a363244574938304b5148784a62415261344e464930306e6f4f443752446432335071446d335561436d586249416c42524836792f526c674970736b4a6d4161324e77614444483337514e50306448c3434d6d3078475635505a396a4c31576c334538514d434e694679475368716949704b776744474f4762627275466152757a5836397269616c516a646f505544447742317851634759325a6f426e456a774a5553364c5a5a6742657132463658757a75716b496962476e4f654854657532667352435678774e454a694b30466567c3516543664f426a5447594139393133454150644e386c4459394571566657387062716479694c4633756d46624e597377674944676e4455504d4d6b4235674b43476d68594f4d75596661323058584d454a6d7778436d6754304143664b38434667654770704e4139643249706559546156356a38727647313564463479463732c371523432436e4777374946536877484673756356336d6575464f75586f48436e59725563524946466b776f45632b5344657862524e634a34746f3141354a514d446e634c305035502f626a4852455938654d64454d4c435868527841633142706330314b442f58527438525a2b53505647775177544467464362786751636363c34e4158383751594254557464686b6e684e62747164624836674139357475317745664f59366f78767a5941394e4e4975412b6441474c34314248455933492f59722f34507276455554486731456963433177735677756946534478767351706e6942785a68466f5850325138513958703866364e534438646b334168746c6b63c34249416d4e59354565523752677573585432554272772f356a5438486445747450547154757a5a3173364735624a44563350677048464967546362444d4346312b33646654537741756d6b5550735a7264556e747234364231443239356b3070394f447647577873507468544f485a7a533754752f6d6a43664d4367686e7131c37778555350442b396e323870555a6e6e3878446f624465374c6a5a483256547867672f56382b37655a546438754b36586877645837357548637872624f4332495a4650574a7141555658694442546f3851476638473348632f3377545679473537662f306c57544c4e6b73316a64304f583650566b786d594a427764646f3270c3782b346b574f78614435487557686f7734424f586a41454e79416f62556a33597238686d475872394f3056374a7242494549787642354347363534454f674e2b4870594d393135726f32784d624564786f472f4e364b646758396f6555454642706b5265436d6b4d68794e616f7a47446f6a3337594e41693432613052723939c3617a597a794159434851545767454271456b69686b4d694641587338414868416959754d3378344e3571376a4837756b564343754f3846726f515868504c4e63447367793859477a717864594b5459773254653239647536303744566e73526862344678593657375a4e4e65704774715a54634c365937386147387944756952c33372563565744d716548746d2f467071505a6567516d4b4b54677a454a346f6e6d753764753672357347446436706b6c30797078764d4153476a4544557a594a7a764f64424a7a4e4b494777655734786a4f417a7570724769487a4e6d6534396f684f4f616d62774c58596b654863436630746441782f636a54486149335864c3523736326d586730416e3141784458597549415434492b4b42615944674772796177516a4e326f6b6141666e2f6e374a5935773742647a345977796e4d5957456d66475444674f37486d3675426f5252437078772b7a43325664753255753148555442694f492b4350543141696c675562524e4163517a396d42593571683166c34271327170362f4e6c6c667a77656f586b63392f754e304d30677a49747332396473437a31496e467678774e707262676a2b6930346335756e657531567a4e4c7871544261464d58694a4f6757304873526f7850556a6942584d53474f65795267317243445547374d5a393964796554572b624d37704f775a31444e2b314951c34a4570756b75547152474867376f59412b6f7037507751534b3372576345776e4457714d657a51714c48344f36464e7336414559792b584476574173734554382b4c4173396f544279553952542f78344d79632f5a535062354d36317449707646367533673154454f7847324859373531643953663455757670594e6a6e3532c3456d2f6434453579643755306a675637486c5a2f4d30554f2b626237776968732f585047627a3572316c7851417131353762614b754f7364573172386c595068754c486865756636305433456a334342695934613435584146627a5a4d316633716f7438426230622b51693242692b556f34636c6859374d376d48774f2b756ac373445a6930347a4e597357394c354c4f66504763314d73564e763679495671793331372f6e7a424c3539682b2f394b776b4c674c4176326138486166573830455730515843657a462f4933596c3749446a676a332f2b6264462b6e63366a335a523776375a3034784f7579584b7a2b45326b5055726f496c332b52724a643743c34439546154384f71504c364465582f4c4234622b3433672f70756c654a5a426d50396649357434767364784344616375693973744641504e6175374462494b676d464630416a634d6d4e4546787a69704d46726f737a6e7a725650434f454d496645466c39766130784a66503552323661456a37346a50412f696d6a6f4c4167c3695969413052576744684441554854484d4d4c77677333776c4e79396d42644f654f67514b33425436575478326d7561346669754465397778583035334174434957367a6f684438646472416357324b48527843486f4430654145774978707448494a68434951514d69787a616430483434396d4c68722b514c754851757363c344485a6962754f6768776263476a674433304134692f62432b4f486f356442463446626f4f5145434936587a4f5a447269644b4e516f4f72395245466f476441596b74383074376343396a62634b2f446a35423730586158726b786569456d6c706752713457526f785946764f64514838483273737771304376307868772b43c34239446b4f527759677864437a676675783673573135684667505231394550415632547a66634b4170697a544964477749516f6d75424878484e436e334c6a4a6872516d2b2f412b4f725156565268517678425951336a68625a506f4d716347305667376767636768776a4f6d5578512b766f68704c6c543367683446464856c32b7a624e334378532b496457316755577959524139646d3972787779526658583876304a757871787478514c516f684f6957734a426f51526a725768777a497a4a316e5562524c6b74772f31703771626c4736506a556a53473468522b452b6a6f59486350532f4e4278495872336d576539472f313139614b75712f75343638c352774c64426777374967596f4b754e734b512b41347a5347416237315342716d4545676d58584272626f4a73544b4a474b65356c6d656f376d576f5a734544535a376d47316f4c735555566469325a626f2b6d445153596751624d6f6a2b67746a4342706d3248354a5964397532694f32756f71466e59554364454a66335843c3644149514a6c6f3242396f4250412b4e684f4242623659574a61583077706d784137595278357468595a496567424d3341576b494979754445466e74475165757a644f71465632384263556c776e696148547361744e4e42794f356b4372584e3246694e6c366d4c6c6f577734706252495944644d4365517064457754576a4bc34533645067524d54324d6d5263793339396c556c7658736c74586e37666a6d6d57344447514b57684467496d6741664974697a6251435842344e4c526f39714c4b326c656174424f73513430652b46726d55774e674a5767496d3355437568645379484d2f5a7159467672654d686138366c6f73593669777a67715550384347c355396874347a6463334358597a556a414e7a707a6e6543783050574b45754251314766734a4176466a4d4974784735326865614e73613779746d2b486f55374c49706631756b506e544a7535514350534b4259384134474957345963504768565a3872646750504e326d4f4e323979343739756a5870675776743552426e4736c336506b3930656a48486766356b682b49374d31777a6469487a54395a686c372f4a4c48374b67586c5a6a427269684b674166493853466b4d6a4347554b4745336b784179664b744f324871316d7a6d6765757270654f496468644c3359696a564863492b6c624c6c426a677732493741694d4d5a684e392b45532f4e37555047c37846767451367977517451772f456f6142313149673033365334466443334c65436847374d50366169393076774f612f326c6746445443334376693046412b5167464a3835336f593367526c734f474f676f334f6e732f6a6f33372b45624473702b396a7a58393948586a7942614a415369496d7044454243424d303038426ac3787133524c2f2b556574432b4c6c554f7036675936625a6346504a6f4b3967572b4179782f373444553446673074373336733162586c30763232346769303177665053593878556762337a37504132665242554630724d70692f793279324c394e3237323946614249626434794450783767576c416361514831505130384f4ec3386c6b576b484f3933393353753262366b545638776348536f7851784d3345646f426d737059307a31674a336a5831476a64794e465770794a6d39315270754c6f44766a4f6f7571366a333874635847594e6f4e58676b657042344544383938417171334a345434304268483755677648506a67305144346543397746786952c359435334487046434b72585337777655753662366b32396a324978516c4568425133614f6a6767314e6773776243617244595234392f6c3032376233583362564a45644843386f5a6f6f384b424847556974543250302f4330336a5078513933446838723561617775395a62387848384a644436497267697576447351514876c3466444667a493244577351412f7358543763377358646253787136413756493433474152704947366a577656434c505262466f4738754f475550524e353050706e75364634636167594c6348744d4142366436564c4e6f4946682b66416a38485935327273576362667145314d62346e774e416b52674e73584e36776242737ac367324158506d6d6f5474476d72765862677432574c467075565a766761424b49695148364f4c345a75674d41364744786252766543422b4e7573735764436c4f474263614e75674a4e66566f54784475676a424c3642365a67774b7530616c6e59743042616f4939763062542b434b4333476a5467777945484543654648474cc36d5242392b4a6f2b2b61584e69784b467469316c324d4b38456a4439462b4744615162364c64386d4d586e44417757767062654e4a63694331564e7242697a77637645514a41454255544174724177314d744267586839305071326d385a6e70714c723468627270694b4f33787879302f394f50676d7939687950634535616ac37747332b4876686557316333396d7037676e3733724a4972462b69566358764f415842686348457375436c544f4b694a63666b6d7462434b306468704d482b347154644a4b307a786a4e42425557583579564d394c3465433065534731422b2f477a616474794c56627846427577587250617531546973435130364769547238c3584e5a494d636e2b6c4d4e36324551324c5175416c44506f597172356b46625067302b33494a48355537795972377453624463464e6354435975734f57334f7375446d6c47364b424c78446a542b52746f3566646b4c35623059526e645872753039726f613878525766557563587439377a5769746b4b673779387265633564c32f56573973366a3078666e4e4c47593777746a2b4478652f4c535463376d6e436a35304a6e524e55775448787673476b6258397a767972625065456436633058684d652f49385752575634326134587277756235334453794f71703576767636365858394a58586e6872696774767939665a2b75586a5a3773755470526e6c56c32f74754f39466e6c6c5035784662546c5a515a453778486f544775364c3070584c65453854696841454635386c7977342f4459365034425850694c6274715a706d6e3871365836586e36396c7264386657693974716c656a4630465664626e782f7a4253446c45764d797265335a73454c4f62326a473672666639614958464ac36a4a72357645787871544f5637484d6d554c5850786c3733595433754572382f58682f384e7a617048416464692f656d62676854534872347a5868797a466179646171717776555657702f454279356e6772347264424c70494d35503562663865303549555a59504b79384f62766d4b6568734665396b4c395844782b515a76c36946312b684972705633524c5a6333736566302f76667a54504f6b502f642f644e5247643969616937706e587854456f78646b7134764736396858693543764a50694d623933645076794c337736794b376e42367446654c436964343058674b4759764a363673574e48494f533370346a783565687552664e6364706330566bc3516e6a7138626270662f35586d4f68786455715553733574677364734366495a366e38315a435a4b756d32396636436c746347477a5a433178352b4f327943594f78726531464f37785864556453765a4830746f5862346c4c4e6a7966394c4a50335531517631395150644b4f3465504e6b636c4670714b33624963567a6262c33775454e76306644384b4865434b48746c52424548453330734e7833494a4f59426843327a3551633578484354706f65336f756d2f366a65766e38553475735949743331567466393335494566624459614e7456357455372f4d464f2f6a70432b5336394c5158655673796c3675687a5267382f4b716638687952444f776e61c36933386f6b686e4a65666945746d2b387362626b334f32584b7a38376c5933685056713064724365494734323069326c662b475738684d4a7a75522f79334c33366275767874794e38793358546c62356e504d755676532f346d3872664d62336e79743878504a463469387846622f706270746b79334a563562707473536e79c33372743733693175577235456e43722b6b36686b452f454a65346362656f2f704a762f527263366d4f344173593347666877666f34582f427432742f4a3966416d6a5a6565524c595a713851315454304250376b5153446b786873734b4c61686f702b4b464d33645a68697a62774733516d4e357331586e37543968726d4d5ac36f426b576a59386c376b484e2b4f45503767303453374b66693136685356757835385839666452353862784c4b2f412f794441456c33486e31756764654b6f4d4d54415449424d6b3364304248534d617350454f5130484d644679426470706f6c706a717362426b4347783546436d736e54694d78706c446e78344a53414c46c347443770633159446d724c4563735161686a6d544b4e4b446a4e456965585759417356386563364535694934686456456a4b4376327969714a436f34715545794f5267747a72704777544a6e704b4b367753715747377643537778734f534e716c79412f4f613237776c3334696b334f62384e6d524f653574547477546c6f49c367416570445634316d786b5a5968326d694c646f416f387179326a58316a53317074322b4e39436f77304f596834694f2f704f74494f746f2b44626745617368616651317741384270766a736e486167692b594f3577454b7478424c7473333047432f43494a4b2f454e305762494969464c675967433251726b4b4a4372514ac334432b53566b2b5a4964764861726148384a2b5657493833384c4751706b4b704256516b35527a4247415551584d4b6d4256415649436e486c757954774f6569726f4b3643737277534e456b523534366c514152643457324232644f77306c443742513551695334676d51467a65554b56465633433577594f396f702b634170c3465849754b677234437931684930564e4255516173456562326b724a654474676f364b7569716f4b654366676c614a537549684177464d685849556943695148594a495166646b6f4d496551726b567946545679424467637753346e316d6250764d4c6d6b7251557346695172614b7569556f462f775131684e4642574f5746c3674758557164593349684e48316831427a5435667274465a6d357054414c74655557683263327938782b69596b55694f30745970546662625563736134694e6b7245484f5374746374555470537446794448624a575a655775744d6a4d6e7733494c6b50634f4b6374795a68446a4f345833776b477a41446b5a78437041546ac34d6842636970496e594263717149553443634b6c4c5561334b715345475679616b694263306d70386f7179334b713749497169314e6c4631525a6e4371376f4d7269564e6b46565a6267565547564a586856594c593456585a426c5356345657626d564e6b465652616e79696c345a5847716e49497177716c7943716f497038c36f7071434b634b716567696e43716e4b496977716c7943716f4970386f7071434b634b716667466546554f5156566846506c466c5152547056625547567a717479434b70745435525a55325a77717436444b356c53354256553270386f74714c4935565735426c63327063677571624536565731426c6336713867697162552bc3587867566f3654613648694531387041697063483153674a594b4568573056644252515663467652496b756c4162317a636c524254495669424867567746386854494c794754534376752b6c594257697049564e4257515563465852583053744354773744483964535477374448316453557737444839644355772f41574967c3706b4b35436a5147344a575535526e7963685134464d426249556943695158554b47644941385952484b476772495543425467537746496c76494b4b676d45764b726b4b6b726b4b464170674a5a4a5751623450474a724534426d69706f7153425251567346485256305664425451623845546279696a6c664539592b445241c3567446585255304656425477583945755233726f6c5575774239425251647451554e4654525630464a42556f4b32345572476368504351564d464c52556b4b6d69726f4b4f4362676b616668455959483836626b45694e327536634136496a4f42303452785551566346505258304652416c72416f614b6d68575147454d4145c3515369566b673969586b5679474a746f414d4254495679464967556b4b656b426541694952734258495579465567543448384b6d546f4a635339466c363943446b64496c4d74336d434438484561666e49646b2b594f5142376c7951627a415a3848565a7857377152597675776836634649626e44337870522b4645376a4952c37048456974476537316f706531496674685666686847536276725346703551534c615663544f68687847695051685a4163492f777244544b2b73777a4e6b6f6f6a6a4a4f55476a374a734d5467414a455a625278426e434b3855764164546746696e68624d6a42676435334b32456562796f73793171696d6d484b7569706f4bc32b41764b55563046424255775574465351717957354a4d67633946665156304e4a56304642425577557446535171623879534e774b3253706944524156744658525530433141446e6c716f712b416b6e575737453672374537624c6c6854514c59434f51726b4b70436e514834564d765553516863416d326d596c6b7a6b6b79c3616d4a634936546a68413344306f346d684c644a734d463230757a71584b474e78787451315a7065385661736d70453645794b636a626772344343674b336f4b4743706770614b6b685530433542584c336e346d2f4b706a7569687973675555466242523056644658515530472f42486c734b4a727646364376674c4b394a57c3696f6f4b6d436c676f534662525630436c42542b715a6d4d6e79684e745567527746636858495579432f436e486174354252516e7969536d516c456a523046545255304652425377574a43746f71364a536752325265713441634258495679464d677677714a6c7057516f55436d416c6b4b744b3364386f76616a652b496152c34b4a744a69416b56684c304652425377574a43746f71364b696771344a654364714636524261626865326f774a364b7567726f47784343526f71614b716770594b6b424932534e33494f316c51685634453842664b726b4b55726b4b464170674a5a436b533245506752524b447843346e6939664d5a444f3644384d77514763c36c6c445679385741544a39615a634f4371657747733836464738514665374c4638755945307a4773644a6545546e754951306c6c7373796d76795a65482b49693365694d3735332b576c366d326e4b3255652f6e78333835553858693375634e6a6b766376426a673064316457583077322b2b4c366953654f68794871624773c3694b4c484a686464666a65764b5a384f313134326634326c377a4959373655344c516e4d304b583535686b646748495a2f57624c796932735533574c766c34374877317753766b4c2f6f5466766437544f383365506570637864504f66616c543872543935325433726a4a354e70623977746e7058746c732b34647266762f33c36156393447373471485337765a35314b377941472b33664146312b78636e355849382b72682f504f327162376432315a655175375558687275314e332b37745a6545752f774e31613538364c574c623958694270795665486136364a5869616367756635794864306e353474396c75734b487a34764861744c313851334c3134c33062793366735754696e4c327556754d3058634e683159303947555969666948372f48742f5a7a572f7030462f7a4c6b5346776f637a5871343359424f697a5862337a68526658466e6a537a62344b437a4c6e74455866505765384b3451715458644d7668627359306c2b4f4d357a572b3265696f6565384268445757673352c36a786c30643445753468724976493037543662716b776e5a4e4e6b4b2b543955625a7443413358764158613966466472544771306e58795934443534556b6e733754323171707770593270493275614d6866376f31774a31536131544f63304f77353767626f4c3448614f56747743796a6f334c37574b747266454f58616f35c368464d7439437555673269796d2b633970517145474f32374d575547666c447076474b7a3351525333374a6d58464539794167692b364435506c63337837544653457a326248395431356b305665665471323168664b477661724c7a727a39446f7448765638393963514734384f697263492b6655497537435a7456634d6963c3526d563741564c79474b46784c336938363646393237747058736c7a6837762b69632f614a7a3934764f3279383666372f6f444833502b4f35586933645773767656347033523361385737393761505375477357664e4d5061734773616564635059733349596539594f63382f6159653537304e6a7a7147487557542f4d5065c37548755766394d506573482b616539635063733336596539595061382f365965315a5036783965315637316739727a2f706837566b2f724433726837566e2f62443272422f576e76574437466b2f794a3731672b785a503869653959507357542f496e76574437466b2f794a3731672b785a5038696539635065733337596539c3595065382f365965395a502b7839422b5a37316739377a2f706837316b2f374433726837316e2f58443272422f4f6e76584432624e2b4f487657443266502b754873652b5a717a2f726837466b2f6e50337078347656754c6756746a6f6a342b785059336255344f35506833625673442b74326c58442f765273567733373037c378644e52423539323659626e4142742f346f50442b5a50615642593131424874707558544934545a5952766a6d4f4a39707142522b6e79315173475733587638317535326d534a2f78674b7436637a34453536315157664d554e41504b38355769315468624a6c797736776d5845616f624c4c41315a6e754f31434a4b55616ec3616564316647336c7a634a4a4358533561445a532b6a69315a4d6b7857627a33646932717a54386a714757764d4269626857345249504c5438746e37492f5475647a584445716d6e4f617a4e6573735837556d392f5375787758567758337855304a78564962587173516378364a783858787850486a5462336e2b76506b5772c34a36734d5148324e5073726c67552f66794c547639702f7749664c35394d7844766c54515251782b4f3073554b4c7930793143774b4b5a373378396d682b556353537a755531483442346c415831357431336b4a73762b3758755054692b5175617834724b4b563955766b444e2f426f7a693579747271314751375a4a6c7a2fc34e43326f6f6c77654d7273627341714336544a4947514e74347357373958546e4457317869507233716261333445585333332b76582f416d524e2b6d794532774141000564656c74610100000a636f6d707265737365640101000009000974696d657374616d7000427868b24a3d1000000009"
        val dataAsArray = data.decodeHex()
        println(dataAsArray.size)
        val rtmpPacketDecoder = RTMPPacketDecoder(dataAsArray.inputStream().toByteReadChannel())
        val payload = rtmpPacketDecoder.readPayload()

        val byteChannel = ByteChannel(autoFlush = true)
        val byteChannel2 = ByteChannel(autoFlush = true)

        /*        launch(Dispatchers.IO) {
                    val buffer = ByteArray(1024)
                    while (isActive) {
                        val bytes = byteChannel.readAvailable(buffer)
                        println("bytes : $bytes")
                        if (bytes == -1) {
                            break
                        }
                    }
                }*/


        /*        val rtmpPacketEncoder = RtmpPacketEncoder(byteChannel, rtmpPacketDecoder.header)
                rtmpPacketEncoder.encode(payload)
                */
        //spoofer

        //readbytechannel2
        val buffer = ByteArray(1024)
        var dataArray = ByteArray(0)
        launch(Dispatchers.IO) {
            while (isActive) {
                val bytes = byteChannel2.readAvailable(buffer)
                dataArray += buffer.sliceArray(0 until bytes)
                println("bytes : $bytes")
                if (bytes == -1) {
                    break
                }
            }
        }

        val rtmpPacketEncoder2 = RtmpPacketEncoder(byteChannel2, rtmpPacketDecoder.header)
        rtmpPacketEncoder2.spoof(payload, rtmpPacketDecoder.originalPayloadData)

        //byteChannel.close()
        byteChannel2.close()

        //assert(byteArray.contentEquals(dataAsArray))
        assert(dataArray.contentEquals(dataAsArray))
    }

    private fun String.decodeHex(): ByteArray {
        check(length % 2 == 0) { "Must have an even length" }

        return chunked(2)
            .map { it.toInt(16).toByte() }
            .toByteArray()
    }

    @Test
    fun `should proxy`(): Unit = runBlocking {
        val proxy =
            LeagueProxyClient("127.0.0.1", 8484, "prod.euw1.lol.riotgames.com", 2099)
        proxy.start()
    }
}
